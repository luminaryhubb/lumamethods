import React, {useEffect, useState} from 'react'
export default function Users(){ const [users,setUsers]=useState([]); const [q,setQ]=useState(''); useEffect(()=>{ fetch('/api/admin/users').then(r=>r.json()).then(d=>setUsers(d.users)).catch(()=>{}) },[]); function search(){ return users.filter(u=>u.username.toLowerCase().includes(q.toLowerCase())||u.id.includes(q)) } async function addUses(id){ const amt=prompt('Quantidade de usos a adicionar'); if(!amt) return; await fetch('/api/admin/user/'+id+'/adduses',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({amount:amt})}); alert('Adicionado'); } async function setRole(id){ const role=prompt('Role (free,vip,mod,admin)'); if(!role) return; await fetch('/api/admin/user/'+id+'/setrole',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({role})}); alert('Setado'); } return (<div><h3>Usu√°rios</h3><div style={{marginTop:8}}><input placeholder='Pesquisar' value={q} onChange={e=>setQ(e.target.value)} className='nav-btn' /></div><div style={{marginTop:8}}>{search().map(u=>(<div key={u.id} className='card' style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:8}}><div><div style={{fontWeight:600}}>{u.username} <span style={{opacity:0.7}}>({u.id})</span></div><div style={{opacity:0.8}}>Uses: {(u.uses||[]).length}</div></div><div style={{display:'flex',flexDirection:'column',gap:6}}><button className='nav-btn' style={{background:'var(--purple)'}} onClick={()=>addUses(u.id)}>Adicionar Usos</button><button className='nav-btn' onClick={()=>setRole(u.id)}>Colocar Cargo</button></div></div>))}</div></div>) }
